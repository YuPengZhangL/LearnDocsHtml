<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>mysql 中的存储过程 | YupengZ个人文档</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="开源技术资料整理">
    
    <link rel="preload" href="/LearnDocsHtml/assets/css/0.styles.0042faaf.css" as="style"><link rel="preload" href="/LearnDocsHtml/assets/js/app.0f1bd8f2.js" as="script"><link rel="preload" href="/LearnDocsHtml/assets/js/3.67df8e7b.js" as="script"><link rel="preload" href="/LearnDocsHtml/assets/js/54.c5125de3.js" as="script"><link rel="prefetch" href="/LearnDocsHtml/assets/js/10.9deb6ef0.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/11.3e7a30f5.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/12.f0875641.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/13.23510c83.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/14.1f896a53.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/15.a162b02a.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/16.82837904.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/17.04907854.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/18.6ec2e925.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/19.82048133.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/2.084dc933.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/20.183aa861.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/21.33901b63.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/22.847aefdb.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/23.74ed3a9b.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/24.b6ba552b.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/25.1b9d230d.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/26.722cab78.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/27.1147dee1.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/28.f2857d64.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/29.11c8e912.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/30.129c224b.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/31.465857e6.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/32.182268cf.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/33.71679196.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/34.fe242440.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/35.8644ff0d.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/36.1f916d97.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/37.17fdfdba.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/38.7f72ddd5.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/39.048c9500.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/4.be19bd86.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/40.dd9db2e3.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/41.a1ab8356.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/42.beb5e602.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/43.dc67e933.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/44.0af8c02a.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/45.eb75ee6a.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/46.c5ce7e98.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/47.f067c624.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/48.4bf4f48b.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/49.f0a75c7f.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/5.a338d993.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/50.03abd7d4.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/51.880e9109.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/52.c48b61d7.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/53.0059f21f.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/55.23d722dd.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/56.4a2270bb.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/57.8c988ee6.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/58.3a86a376.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/59.9fcb676b.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/6.9da9678c.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/60.24a5563f.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/61.3b2aaed9.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/62.339f6e71.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/63.1edaf49b.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/64.65ae4ca8.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/65.5f0e8f08.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/66.cfc630d1.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/67.f63acc95.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/68.a3f12ccf.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/69.88b6028b.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/7.c63f6924.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/70.ce51048a.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/71.7b143a95.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/72.d736ae69.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/73.f4164019.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/74.fe5ebe4a.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/8.3b044c8a.js"><link rel="prefetch" href="/LearnDocsHtml/assets/js/9.96e8b5d8.js">
    <link rel="stylesheet" href="/LearnDocsHtml/assets/css/0.styles.0042faaf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/LearnDocsHtml/" class="home-link router-link-active"><img src="/LearnDocsHtml/logo.jpg" alt="YupengZ个人文档" class="logo"> <span class="site-name can-hide">YupengZ个人文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="目录" class="dropdown-title"><span class="title">目录</span> <span class="arrow down"></span></button> <button type="button" aria-label="目录" class="mobile-dropdown-title"><span class="title">目录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/es/" class="nav-link">
  ES
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/etcd/" class="nav-link">
  Etcd
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/kafka/" class="nav-link">
  Kafka
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/kubernetes/" class="nav-link">
  Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/mongodb/" class="nav-link">
  mongodb
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/mysql/" class="nav-link router-link-active">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/postgresql/" class="nav-link">
  Postgresql
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/zookeeper/" class="nav-link">
  Zookeeper
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="目录" class="dropdown-title"><span class="title">目录</span> <span class="arrow down"></span></button> <button type="button" aria-label="目录" class="mobile-dropdown-title"><span class="title">目录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/es/" class="nav-link">
  ES
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/etcd/" class="nav-link">
  Etcd
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/kafka/" class="nav-link">
  Kafka
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/kubernetes/" class="nav-link">
  Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/mongodb/" class="nav-link">
  mongodb
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/mysql/" class="nav-link router-link-active">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/postgresql/" class="nav-link">
  Postgresql
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/LearnDocsHtml/doc/zookeeper/" class="nav-link">
  Zookeeper
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/LearnDocsHtml/doc/mysql/1.1 mysql 的系统结构.html" class="sidebar-link">mysql 体系结构图</a></li><li><a href="/LearnDocsHtml/doc/mysql/1.2 mysql 的存储引擎.html" class="sidebar-link">1. 存储引擎</a></li><li><a href="/LearnDocsHtml/doc/mysql/2.1 mysql 中的索引.html" class="sidebar-link">mysql 中索引语法以及分类</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/2.2 mysql 中的索引结构.html" class="sidebar-link">mysql 中的索引结构</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/2.3 sql 分析工具.html" class="sidebar-link">sql性能分析</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/2.4 索引使用原则.html" class="sidebar-link">索引使用原则</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/3.1 sql 优化.html" class="sidebar-link">SQL 优化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/4.1 mysql 中的视图.html" class="sidebar-link">mysql 中的视图</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/4.2 mysql 中的存储过程.html" class="active sidebar-link">mysql 中的存储过程</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/4.3 mysql 中触发器.html" class="sidebar-link">mysql 中的触发器</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/5.1 mysql 锁的基本概念.html" class="sidebar-link">mysql 中的锁</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/5.2 mysql 中的表锁.html" class="sidebar-link">表级锁</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/5.3 mysql 中的行锁.html" class="sidebar-link">行级锁</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/6.1 mysql 中InnoDB的架构.html" class="sidebar-link">mysql 中InnoDB 架构详解</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/6.2 mysql 中的事务.html" class="sidebar-link">mysql 中事务</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/6.3 mysql 中事务的MVCC.html" class="sidebar-link">mysql 事务中的MVCC</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/7.1 mysql 中的日志.html" class="sidebar-link">mysql 中的日志</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/7.2 mysql 中的主从复制.html" class="sidebar-link">mysql 中的主从复制</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/7.3 mysql 中的分库分表.html" class="sidebar-link">mysql 中的分库分表</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/LearnDocsHtml/doc/mysql/7.4 mysql 中的读写分离.html" class="sidebar-link">mysql 中的读写分离</a><ul class="sidebar-sub-headers"></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="mysql-中的存储过程"><a href="#mysql-中的存储过程" class="header-anchor">#</a> mysql 中的存储过程</h3> <h4 id="_1-什么是存储过程"><a href="#_1-什么是存储过程" class="header-anchor">#</a> 1. 什么是存储过程？</h4> <p><strong>存储过程思想上很简单，就是数据库 SQL 语言层面的代码封装与重用。</strong></p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>MySQL5.0 版本开始支持存储过程。

大多数 SQL 语句都是针对一个或多个表的单条语句。并非所有的操作都那么简单。经常会有一个完整的操作需要多条语句才能完成。

存储过程简单来说，就是为以后的使用而保存的一条或多条 MySQL 语句的集合。可将其视为批处理文件。虽然他们的作用不仅限于批处理。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_2-存储过程的使用"><a href="#_2-存储过程的使用" class="header-anchor">#</a> 2. 存储过程的使用</h4> <h5 id="_2-1-mysql-中的变量"><a href="#_2-1-mysql-中的变量" class="header-anchor">#</a> 2.1 mysql 中的变量</h5> <p><strong>1) 系统变量</strong></p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>系统变量那肯定就是mysql数据库为我们提供的，再细化的话又可以分为两种：全局变量和会话变量。

自定变量就是用户自己定义的，而不是由系统提供的。自定义变量也可以分为两种：用户变量和局部变量。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>2) 查看所有的系统变量</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> <span class="token keyword">global</span> variables<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------------------------+----------+</span>
<span class="token operator">|</span> Variable_name                     <span class="token operator">|</span> <span class="token keyword">Value</span>    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------------+----------+</span>
<span class="token operator">|</span> auto_increment_increment          <span class="token operator">|</span> <span class="token number">1</span>        <span class="token operator">|</span>
<span class="token operator">|</span> auto_increment_offset             <span class="token operator">|</span> <span class="token number">1</span>        <span class="token operator">|</span>
<span class="token operator">|</span> autocommit                        <span class="token operator">|</span> <span class="token keyword">ON</span>       <span class="token operator">|</span>
<span class="token operator">|</span> automatic_sp_privileges           <span class="token operator">|</span> <span class="token keyword">ON</span>       <span class="token operator">|</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token comment">-- 模糊查询</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> <span class="token keyword">global</span>  variables <span class="token operator">like</span> <span class="token string">'auto%'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------------+-------+</span>
<span class="token operator">|</span> Variable_name            <span class="token operator">|</span> <span class="token keyword">Value</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+-------+</span>
<span class="token operator">|</span> auto_generate_certs      <span class="token operator">|</span> <span class="token keyword">ON</span>    <span class="token operator">|</span>
<span class="token operator">|</span> auto_increment_increment <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">|</span> auto_increment_offset    <span class="token operator">|</span> <span class="token number">1</span>     <span class="token operator">|</span>
<span class="token operator">|</span> autocommit               <span class="token operator">|</span> <span class="token keyword">ON</span>    <span class="token operator">|</span>
<span class="token operator">|</span> automatic_sp_privileges  <span class="token operator">|</span> <span class="token keyword">ON</span>    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+-------+</span>
<span class="token number">5</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>3) 查看某个指定的系统变量</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- select @@global.变量名称；查看会话的变量值的时候只需要把global变成session就可以了</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> @<span class="token variable">@global.version_comment</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token operator">|</span> @<span class="token variable">@global.version_comment</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token operator">|</span> Source distribution      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>4) 为某个变量赋值</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">set</span> <span class="token keyword">global</span> 系统变量名 <span class="token operator">=</span> 新值；
<span class="token keyword">set</span> @<span class="token variable">@global.</span>系统变量名 <span class="token operator">=</span> 新值；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>5) 声明初始化</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">set</span> @用户变量名 <span class="token operator">=</span> 值
<span class="token keyword">set</span> @用户变量名 :<span class="token operator">=</span> 值
<span class="token keyword">select</span> @用户变量名 :<span class="token operator">=</span>值
<span class="token comment">/*
mysql :=和=的区别

    1) 执行set和update语句时，这两个符号都是赋值的意思

    2) 执行select语句时，用:=赋值后，相当于set+select，该变量会在当前会话中永久显示成新值；用=赋值后，再次查询该变量，还会是原来的值
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>6) 局部变量</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 1) 声明</span>
<span class="token keyword">declare</span> 变量名 类型；
<span class="token keyword">declare</span> 变量名 类型 <span class="token keyword">default</span> 默认值

<span class="token comment">-- 2) 赋值</span>
<span class="token keyword">set</span> @用户变量名 <span class="token operator">=</span> 值
<span class="token keyword">set</span> @用户变量名 :<span class="token operator">=</span> 值
<span class="token keyword">select</span> @用户变量名 :<span class="token operator">=</span>值

<span class="token comment">-- select 字段 into 自定义变量 from 表名</span>
<span class="token comment">/*
该语法在mysql中不支持，可以使用create table + insert into 
*/</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="_2-2-存储过程的创建"><a href="#_2-2-存储过程的创建" class="header-anchor">#</a> 2.2 存储过程的创建</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- CREATE PROCEDURE 存储过程名([[IN |OUT |INOUT ] 参数名 参数类型...]) [特性 …] 过程体</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> sp_name <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">IN</span> <span class="token operator">|</span><span class="token keyword">OUT</span> <span class="token operator">|</span><span class="token keyword">INOUT</span> <span class="token punctuation">]</span> $param $param_type<span class="token punctuation">)</span> <span class="token punctuation">[</span>$characteristic …<span class="token punctuation">]</span> $routine_body

<span class="token comment">-- IN 输入参数：表示调用者向过程传入值</span>
<span class="token comment">-- OUT 输出参数：表示过程向调用者传出值</span>
<span class="token comment">-- INOUT 输入输出参数：既表示调用者向过程传入值，又表示过程向调用者传出值</span>

<span class="token comment">-- $param_type ：表示任何有效的MySQL数据类型</span>
<span class="token comment">-- $characteristic :表示 </span>
<span class="token comment">-- | LANGUAGE SQL: 说明'过程体'部分是由SQL语言的语句组成，这也是数据库系统默认的语言</span>
<span class="token comment">-- | [NOT] DETERMINISTIC: 指明存储过程的执行结果是否是确定的。</span>
<span class="token comment">-- |                      DETERMINISTIC表示结果是确定的。每次执行存储过程时，相同的输入会得到相同的输出</span>
<span class="token comment">-- |                      NOT DETERMINISTIC表示结果是非确定的，相同的输入可能得到不同的输出。</span>
<span class="token comment">-- |                      默认情况下，结果是非确定的。</span>
<span class="token comment">-- | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }:  指明子程序使用SQL语句的限制</span>
<span class="token comment">-- | SQL SECURITY { DEFINER | INVOKER }: 指明谁有权限来执行</span>
<span class="token comment">-- | COMMENT 'string': 注释信息</span>

<span class="token comment">-- $routine_body： 表示有效的SQL过程语句或语句,又叫'过程体'.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>characteristic值含义</strong></p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>1) NOT DETERMINISTIC ：如果程序或线程总是对同样的输入参数产生同样的结果，则被认为它是“确定的”，否则就是“非确定”的。如果既没有给定DETERMINISTIC也没有给定NOT DETERMINISTIC，默认的就是NOT DETERMINISTIC。
2) CONTAINS SQL ：表示子程序不包含读或写数据的语句
3) NO SQL表示子程序不包含SQL语句
4) READS SQL DATA表示子程序包含读数据的语句，但不包含写数据的语句
5) MODIFIES SQL DATA表示子程序包含写数据的语句
6) 如果这些特征没有明确给定，默认的是CONTAINS SQL
7) SQL SECURITY特征可以用来指定 子程序该用创建子程序者的许可来执行，还是使用调用者的许可来执行。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>in/out/inout的使用</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/*-----------------------------------------------------------------------------*/</span>
<span class="token comment">/*------------创建一个无参数存储过程---------------------------------------------*/</span>
<span class="token keyword">DELIMITER</span> $$
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test1<span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">BEGIN</span>
 <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test<span class="token punctuation">;</span>
 <span class="token keyword">END</span>$$
<span class="token keyword">DELIMITER</span> $$

<span class="token comment">-- 1.声明语句结束符$$</span>
<span class="token keyword">DELIMITER</span> $$

<span class="token comment">-- 2.声明存储过程:</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test1<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">-- 3. 存储过程开始和结束符号</span>
 <span class="token keyword">BEGIN</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token keyword">END</span>$$ 


 <span class="token comment">/*-----------------------------------------------------------------------------*/</span>
<span class="token comment">/*------------创建一个in 输入参数的存储过程---------------------------------------*/</span>
<span class="token keyword">DELIMITER</span> $$
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test2<span class="token punctuation">(</span><span class="token operator">IN</span> pr_id <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
 <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test <span class="token keyword">WHERE</span> id<span class="token operator">=</span>pr_id<span class="token punctuation">;</span>
 
<span class="token keyword">END</span>$$
<span class="token keyword">DELIMITER</span> $$

<span class="token comment">-- 调用b的存储过程</span>
<span class="token keyword">CALL</span> test2<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除存储过程</span>
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> test2<span class="token punctuation">;</span>


<span class="token comment">/*-----------------------------------------------------------------------------*/</span>
<span class="token comment">/*------------out 的存储过程的说法----------------------------------------------*/</span>
<span class="token keyword">DELIMITER</span> $$
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test3<span class="token punctuation">(</span><span class="token keyword">OUT</span> pr_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token keyword">BEGIN</span>
 
 <span class="token keyword">SELECT</span> NAME <span class="token keyword">INTO</span> pr_name <span class="token keyword">FROM</span> a <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
 
 <span class="token keyword">END</span>$$
 
 <span class="token keyword">DELIMITER</span> $$

<span class="token comment">-- 调用test3的存储过程 out是输出，所以调用存储过程时这是一个变量@name</span>
<span class="token keyword">CALL</span> test3<span class="token punctuation">(</span><span class="token variable">@name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 然后显示值</span>
<span class="token keyword">SELECT</span> <span class="token variable">@name</span>


<span class="token comment">/*-----------------------------------------------------------------------------*/</span>
<span class="token comment">/*------------inout 的存储过程的说明--------------------------------------------*/</span>
<span class="token keyword">DELIMITER</span>$$
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test4<span class="token punctuation">(</span><span class="token keyword">INOUT</span> pr_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
 <span class="token keyword">SELECT</span> NAME <span class="token keyword">INTO</span> pr_name <span class="token keyword">FROM</span> a <span class="token keyword">WHERE</span> id<span class="token operator">=</span>pr_name<span class="token punctuation">;</span>
<span class="token keyword">END</span>$$
<span class="token keyword">DELIMITER</span> $$

<span class="token comment">/*调用inout的存储过程 
inout是可以接受一个参数并输出一个参数
*/</span>
<span class="token comment">/*设置一个参数，@id=5 说明输入的参数为5*/</span>
<span class="token keyword">SET</span> <span class="token variable">@id</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">-- 然后在调用返回输出一个值</span>
<span class="token keyword">CALL</span> test4<span class="token punctuation">(</span><span class="token variable">@id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 显示存储过程</span>
<span class="token keyword">SELECT</span> <span class="token variable">@id</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br></div></div><h5 id="_2-3-存储函数的基本语法"><a href="#_2-3-存储函数的基本语法" class="header-anchor">#</a> 2.3 存储函数的基本语法</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/*存储过程体*/</span>
<span class="token keyword">BEGIN</span>
　　<span class="token keyword">BEGIN</span>
　　　　<span class="token keyword">BEGIN</span>
　　　　　　statements<span class="token punctuation">;</span> 
　　　　<span class="token keyword">END</span>
　　<span class="token keyword">END</span>
<span class="token keyword">END</span>

<span class="token comment">/*参数申明*/</span>
<span class="token keyword">DECLARE</span> variable_name <span class="token punctuation">[</span><span class="token punctuation">,</span>variable_name<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> datatype <span class="token punctuation">[</span><span class="token keyword">DEFAULT</span> <span class="token keyword">value</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">/*变量赋值*/</span>
<span class="token keyword">SET</span> 变量名 <span class="token operator">=</span> 表达式值 <span class="token punctuation">[</span><span class="token punctuation">,</span>variable_name <span class="token operator">=</span> expression <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>


<span class="token comment">/*if-then-else 语句*/</span>
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> $$  
mysql <span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test5<span class="token punctuation">(</span><span class="token operator">IN</span> parameter <span class="token keyword">int</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">begin</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">declare</span> var <span class="token keyword">int</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> var<span class="token operator">=</span>parameter<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">if</span> var<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">then</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> t <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">if</span> parameter<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">then</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">update</span> t <span class="token keyword">set</span> s1<span class="token operator">=</span>s1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">else</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">update</span> t <span class="token keyword">set</span> s1<span class="token operator">=</span>s1<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> $$  
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>


<span class="token comment">/*case语句*/</span>
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> $$
mysql <span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test6 <span class="token punctuation">(</span><span class="token operator">in</span> parameter <span class="token keyword">int</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">begin</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">declare</span> var <span class="token keyword">int</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> var<span class="token operator">=</span>parameter<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">case</span> var  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">when</span> <span class="token number">0</span> <span class="token keyword">then</span>   
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> t <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">when</span> <span class="token number">1</span> <span class="token keyword">then</span>   
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> t <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">else</span>   
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> t <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">case</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> $$  
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span> 


<span class="token comment">/*while ···· end while*/</span>
<span class="token comment">/*
while 条件 do
    --循环体
end while
*/</span>
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> $$
mysql <span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test7<span class="token punctuation">(</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">begin</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">declare</span> var <span class="token keyword">int</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> var<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">while</span> var<span class="token operator">&lt;</span><span class="token number">6</span> <span class="token keyword">do</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> t <span class="token keyword">values</span><span class="token punctuation">(</span>var<span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> var<span class="token operator">=</span>var<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> $$  
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>


<span class="token comment">/*repeat···· end repeat*/</span>
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> $$ 
mysql <span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test8 <span class="token punctuation">(</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">begin</span>   
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">declare</span> v <span class="token keyword">int</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> v<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">repeat</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> t <span class="token keyword">values</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> v<span class="token operator">=</span>v<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> until v<span class="token operator">&gt;=</span><span class="token number">5</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">repeat</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> $$  
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>


<span class="token comment">/* loop ·····endloop*/</span>
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> $$  
mysql <span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test9 <span class="token punctuation">(</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">begin</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">declare</span> v <span class="token keyword">int</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> v<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> LOOP_LABLE:<span class="token keyword">loop</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> t <span class="token keyword">values</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> v<span class="token operator">=</span>v<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">if</span> v <span class="token operator">&gt;=</span><span class="token number">5</span> <span class="token keyword">then</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">leave</span> LOOP_LABLE<span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">loop</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> $$  
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>


<span class="token comment">/*ITERATE迭代*/</span>
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> $$ 
mysql <span class="token operator">&gt;</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test10 <span class="token punctuation">(</span><span class="token punctuation">)</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">begin</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">declare</span> v <span class="token keyword">int</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> v<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> LOOP_LABLE:<span class="token keyword">loop</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">if</span> v<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">then</span>   
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> v<span class="token operator">=</span>v<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">ITERATE</span> LOOP_LABLE<span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> t <span class="token keyword">values</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">set</span> v<span class="token operator">=</span>v<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">if</span> v<span class="token operator">&gt;=</span><span class="token number">5</span> <span class="token keyword">then</span> 
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">leave</span> LOOP_LABLE<span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span> <span class="token keyword">loop</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">end</span><span class="token punctuation">;</span>  
     <span class="token operator">-</span><span class="token operator">&gt;</span> $$  
mysql <span class="token operator">&gt;</span> <span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br></div></div><h4 id="_3-存储过程的优缺点"><a href="#_3-存储过程的优缺点" class="header-anchor">#</a> 3. 存储过程的优缺点</h4> <h5 id="_3-1-存储过程的优点"><a href="#_3-1-存储过程的优点" class="header-anchor">#</a> 3.1 存储过程的优点</h5> <div class="language-text line-numbers-mode"><pre class="language-text"><code>1) 封装性
    存储过程被创建后，可以在程序中被多次调用，而不必重新编写该存储过程的 SQL 语句，并且数据库专业人员可以随时对存储过程进行修改，而不会影响到调用它的应用程序源代码。

2) 可增强 SQL 语句的功能和灵活性
    存储过程可以用流程控制语句编写，有很强的灵活性，可以完成复杂的判断和较复杂的运算。

3) 可减少网络流量
    由于存储过程是在服务器端运行的，且执行速度快，因此当客户计算机上调用该存储过程时，网络中传送的只是该调用语句，从而可降低网络负载。

4) 高性能
    存储过程执行一次后，产生的二进制代码就驻留在缓冲区，在以后的调用中，只需要从缓冲区中执行二进制代码即可，从而提高了系统的效率和性能。

5) 提高数据库的安全性和数据的完整性
    使用存储过程可以完成所有数据库操作，并且可以通过编程的方式控制数据库信息访问的权限。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="_3-2-存储过程的缺点"><a href="#_3-2-存储过程的缺点" class="header-anchor">#</a> 3.2 存储过程的缺点</h5> <div class="language-text line-numbers-mode"><pre class="language-text"><code>1) 如果使用大量存储过程，那么使用这些存储过程的每个连接的内存使用量将会大大增加。 此外，如果您在存储过程中过度使用大量逻辑操作，则 CPU 使用率也会增加，因为 MySQL 数据库最初的设计侧重于高效的查询，不利于逻辑运算；

2) 存储过程的构造使得开发具有复杂业务逻辑的存储过程变得更加困难；

3) 很难调试存储过程。只有少数数据库管理系统允许您调试存储过程。不幸的是，MySQL 不提供调试存储过程的功能；

4) 开发和维护存储过程并不容易。开发和维护存储过程通常需要一个不是所有应用程序开发人员拥有的专业技能。这可能会导致应用程序开发和维护阶段的问题。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/5/2023, 2:33:10 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/LearnDocsHtml/doc/mysql/4.1 mysql 中的视图.html" class="prev">
        mysql 中的视图
      </a></span> <span class="next"><a href="/LearnDocsHtml/doc/mysql/4.3 mysql 中触发器.html">
        mysql 中的触发器
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/LearnDocsHtml/assets/js/app.0f1bd8f2.js" defer></script><script src="/LearnDocsHtml/assets/js/3.67df8e7b.js" defer></script><script src="/LearnDocsHtml/assets/js/54.c5125de3.js" defer></script>
  </body>
</html>
