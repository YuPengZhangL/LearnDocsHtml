## MQ(Message Queue)

### 1. 什么是MQ(消息队列)?

>1. MQ(message queue)，本质是个队列，FIFO 先入先出，只不过队列中存放的内容是 message 而已，还是一种跨进程的通信机制，用于上下游传递消息。
>2. 在互联网架构中，MQ 是一种非常常 见的上下游「逻辑解耦 + 物理解耦」的消息通信服务。使用了 MQ 之后，消息发送上游只需要依赖 MQ，不用依赖其他服务。


### 2. MQ 解决的优缺点
- 业务异步解耦
> 允许独立的扩展或者修改Queue两边的处理过程，只需要遵守同样的接口约束即可
- 可恢复性
> 系统一部分组件失效时，不会影响到整个系统，mq降低了系统之间的耦合度，即使一个处理消息的进程崩了，已经加入mq的信息可以在系统恢复后进行处理
- 缓冲
> 有助于处理和优化数据流经过系统的速度，解决生产消费处理速度不一致的情况
- 灵活性 & 峰值处理
> 可以预防突发的访问压力，使系统关键组件不至于崩溃
- 异步通信
> 生产和消费不需要强耦合，用户将消息放入到mq中，不需要立即处理，可以放多个，然后再需要的时间进行处理

**缺点**
- 系统可用性降低
- 系统复杂性提高
- 一致性问题

### 3. MQ的两种模式
##### 3.1 **消息发布的两种方式**

> 消费者自己主动拉取
> MQ主动推

**点对点模式**

> 1. 一对一，消费者主动拉取数据，消息收到后清除消息
> 2. 生产者在生产消息发送到Q中，之后消费者从Q中取出消息并消费，消息被消费之后Q中不在存储消息，所有消费者不能消费到已经被消费的消息。
> 3. Q 支持多个消费者，但是一个消息只能被一个消费者消费到

**发布订阅模式**
> 1. 一对多，消费者消费数据之后不会立即清除数据 
> 2. 生产者（发布）讲消息发送到topic中，同时有多个消费知（订阅）消费该消息，发不到topic的消息会被所有消费者消费
