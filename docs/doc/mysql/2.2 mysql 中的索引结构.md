### mysql 中的索引结构

#### 1. 索引结构
- **mysql的索引结构是在存储引擎层实现的，不同的存储引擎有不同的结构，主要包含以下结构.**
- **平常如果没有特指索引的结构，那么默认指的是b+tree结构**

| 索引结构  | 描述 |
| :---: | :---: |
| B+Tree  | 最常见的索引类型，大部分引擎都支持B+树索引 |
| Hash | 底层数据结构是用哈希表实现，只有精确匹配索引列的查询才有效，不支持范围查询 |
| R-Tree(空间索引) | 空间索引是 MyISAM 引擎的一个特殊索引类型，主要用于地理空间数据类型，通常使用较少 |
| Full-Text(全文索引) | 是一种通过建立倒排索引，快速匹配文档的方式，类似于 Lucene, Solr, ES |

-  不同的存储引擎对索引的支持

| 索引 | InnoDB | MyISAM | Memory |
| :---: | :---: | :---: | :---: |
| B+Tree索引 | 支持 | 支持 | 支持 |
| Hash索引 | 不支持 | 不支持 | 支持 | 
| R-Tree索引 | 不支持 | 支持 | 不支持 |
| Full-text | 5.6版本后支持 | 支持 | 不支持 |

##### 2. 二叉树索引结构

###### 2.1 二叉树结构
![image](./image/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%BB%93%E6%9E%84.png)

```text
二叉树的缺点：
    顺序插入时，会形成一个单链表，查询性能大大降低，数据量比较大的情况下，树的高度比较高，索引速度比较慢.
```
###### 2.2 红黑树的索引结构

![iamge](./image/%E7%BA%A2%E9%BB%91%E6%A0%91%E7%BB%93%E6%9E%84.png)

```text
红黑树也存在大数据量情况下，层级较深，检索速度慢的问题。为了解决上述问题，可以使用 B-Tree 结构。
```

###### 2.3 B-Tree索引结构(多路平衡查找树)

![image](./image/B-Tree%E7%BB%93%E6%9E%84.png)

###### 2.4 标准B+Tree 结构

![image](./image/%E6%A0%87%E5%87%86B+Tree%E7%BB%93%E6%9E%84.png)

```text
与 B-Tree 的区别：
    所有的数据都会出现在叶子节点
    叶子节点形成一个单向链表
```

###### 2.5 B+Tree 索引结构(优化之后的)

![image](./image/B+Tree%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84.png)

```text
MySQL 索引数据结构对经典的 B+Tree 进行了优化。在原 B+Tree 的基础上，增加一个指向相邻叶子节点的链表指针，就形成了带有顺序指针的 B+Tree，提高区间访问的性能。
```

##### 3. hash 索引结构

```text
哈希索引就是采用一定的hash算法，将键值换算成新的hash值，映射到对应的槽位上，然后存储在hash表中。
如果两个（或多个）键值，映射到一个相同的槽位上，他们就产生了hash冲突（也称为hash碰撞），可以通过链表来解决。
```

###### 3.1 hash 索引原理图

![image](./image/Hash%E7%B4%A2%E5%BC%95%E5%8E%9F%E7%90%86%E5%9B%BE.png)

###### 3.2 hash 索引的特点
```text
特点：
    Hash索引只能用于对等比较（=、in），不支持范围查询（between、>、<、…）
    无法利用索引完成排序操作
    查询效率高，通常只需要一次检索就可以了，效率通常要高于 B+Tree 索引

存储引擎支持：
    Memory
    InnoDB: 具有自适应hash功能，hash索引是存储引擎根据 B+Tree 索引在指定条件下自动构建的

```
